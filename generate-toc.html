<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table of Contents Generator</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #24292e;
            background: #f6f8fa;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            min-height: 100vh;
            background: white;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        header h1 {
            font-size: 1.5em;
            margin-bottom: 8px;
        }

        header p {
            opacity: 0.9;
            font-size: 0.95em;
        }

        .main-content {
            padding: 15px;
        }

        .input-section {
            margin-bottom: 20px;
        }

        .input-section h2 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .input-section p {
            font-size: 0.9em;
            color: #586069;
            margin-bottom: 10px;
        }

        textarea {
            width: 100%;
            min-height: 250px;
            padding: 12px;
            border: 2px solid #e1e4e8;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s;
            flex: 1;
            min-width: 140px;
            touch-action: manipulation;
        }

        button:active {
            transform: scale(0.98);
        }

        button.secondary {
            background: #6c757d;
        }

        .output-section {
            display: none;
            margin-top: 20px;
        }

        .output-section.active {
            display: block;
        }

        .output-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        /* Mobile-first: Stack layout */
        .results {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 15px;
        }

        .toc-panel {
            background: #f6f8fa;
            border: 2px solid #e1e4e8;
            border-radius: 6px;
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
            order: 1;
        }

        .toc-panel h3 {
            color: #667eea;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #667eea;
            font-size: 1.1em;
        }

        .toc-list {
            list-style: none;
        }

        .toc-list li {
            margin: 6px 0;
        }

        .toc-list a {
            color: #24292e;
            text-decoration: none;
            display: block;
            padding: 8px 10px;
            border-radius: 4px;
            transition: all 0.2s;
            font-size: 0.95em;
        }

        .toc-list a:active {
            background: #667eea;
            color: white;
        }

        .toc-level-1 { padding-left: 0; font-weight: 600; }
        .toc-level-2 { padding-left: 15px; font-size: 0.9em; }
        .toc-level-3 { padding-left: 30px; font-size: 0.85em; }
        .toc-level-4 { padding-left: 45px; font-size: 0.8em; }
        .toc-level-5 { padding-left: 60px; font-size: 0.75em; }
        .toc-level-6 { padding-left: 75px; font-size: 0.7em; }

        .content-panel {
            background: white;
            border: 2px solid #e1e4e8;
            border-radius: 6px;
            padding: 15px;
            order: 2;
        }

        .content-panel h1,
        .content-panel h2,
        .content-panel h3,
        .content-panel h4,
        .content-panel h5,
        .content-panel h6 {
            color: #24292e;
            margin-top: 20px;
            margin-bottom: 12px;
            font-weight: 600;
            line-height: 1.25;
            scroll-margin-top: 20px;
        }

        .content-panel h1 {
            font-size: 1.6em;
            border-bottom: 2px solid #e1e4e8;
            padding-bottom: 8px;
        }

        .content-panel h2 {
            font-size: 1.4em;
            border-bottom: 1px solid #e1e4e8;
            padding-bottom: 6px;
        }

        .content-panel h3 { font-size: 1.2em; }
        .content-panel h4 { font-size: 1.05em; }
        .content-panel h5 { font-size: 0.95em; }
        .content-panel h6 { font-size: 0.85em; color: #6a737d; }

        .content-panel p {
            margin-bottom: 12px;
            line-height: 1.7;
            font-size: 0.95em;
        }

        .anchor-link {
            color: #667eea;
            text-decoration: none;
            margin-left: 6px;
            opacity: 0.7;
            font-size: 0.8em;
        }

        .stats {
            background: #f6f8fa;
            border-left: 4px solid #667eea;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .stats p {
            margin: 4px 0;
            color: #586069;
        }

        .stats strong {
            color: #24292e;
        }

        .copy-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .copy-buttons button {
            font-size: 13px;
            padding: 10px 16px;
            flex: 1;
            min-width: 120px;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(80px);
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
            max-width: 90%;
            text-align: center;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        footer {
            text-align: center;
            padding: 20px 15px;
            color: #586069;
            background: #f6f8fa;
            margin-top: 20px;
            font-size: 0.9em;
        }

        footer a {
            color: #667eea;
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .example-link {
            color: #667eea;
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.9em;
        }

        .example-link:active {
            color: #5568d3;
        }

        /* Tablet and up */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }

            .container {
                border-radius: 8px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                min-height: auto;
            }

            header {
                padding: 30px;
            }

            header h1 {
                font-size: 2em;
                margin-bottom: 10px;
            }

            header p {
                font-size: 1.1em;
            }

            .main-content {
                padding: 30px;
            }

            .input-section h2,
            .output-section h2 {
                font-size: 1.5em;
            }

            textarea {
                min-height: 300px;
                padding: 15px;
                font-size: 14px;
            }

            button {
                flex: 0 1 auto;
                min-width: auto;
            }

            .content-panel h1 { font-size: 2em; }
            .content-panel h2 { font-size: 1.5em; }
            .content-panel h3 { font-size: 1.25em; }
            .content-panel h4 { font-size: 1.1em; }
            .content-panel h5 { font-size: 1em; }

            .toc-list a:hover {
                background: #667eea;
                color: white;
                padding-left: 15px;
            }

            .anchor-link {
                opacity: 0;
            }

            h1:hover .anchor-link,
            h2:hover .anchor-link,
            h3:hover .anchor-link,
            h4:hover .anchor-link,
            h5:hover .anchor-link,
            h6:hover .anchor-link {
                opacity: 1;
            }
        }

        /* Desktop: Grid layout with sticky sidebar */
        @media (min-width: 1024px) {
            .container {
                max-width: 1400px;
            }

            .results {
                display: grid;
                grid-template-columns: 350px 1fr;
                gap: 30px;
            }

            .toc-panel {
                position: sticky;
                top: 20px;
                max-height: calc(100vh - 40px);
                order: 0;
            }

            .content-panel {
                padding: 30px;
                order: 0;
            }

            .toast {
                bottom: 30px;
                right: 30px;
                left: auto;
                transform: translateY(80px);
            }

            .toast.show {
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìë Table of Contents Generator</h1>
            <p>Generiere automatisch ein Inhaltsverzeichnis aus deinem Text</p>
        </header>

        <div class="main-content">
            <div class="input-section">
                <h2>Text eingeben</h2>
                <p>F√ºge deinen Text ein (unterst√ºtzt Markdown-√úberschriften # ## ### oder nummerierte √úberschriften 1. 1.1 usw.)
                    <br><span class="example-link" onclick="loadExample()">üìã Markdown-Beispiel</span>
                    &nbsp;|&nbsp;
                    <span class="example-link" onclick="loadPlainTextExample()">üìÑ Flie√ütext-Beispiel</span>
                </p>
                <textarea id="inputText" placeholder="# Haupt√ºberschrift&#x0a;&#x0a;Dein Text hier...&#x0a;&#x0a;## Unter√ºberschrift&#x0a;&#x0a;Mehr Text..."></textarea>

                <div style="margin-top: 12px; padding: 10px; background: #f6f8fa; border-radius: 6px;">
                    <label style="display: flex; align-items: center; cursor: pointer; font-size: 0.9em;">
                        <input type="checkbox" id="autoDetect" style="margin-right: 8px;">
                        <span>ü§ñ Auto-Erkennung: √úberschriften aus Flie√ütext ohne Markdown-Syntax erkennen</span>
                    </label>
                </div>

                <div class="controls">
                    <button onclick="generateTOC()">üöÄ Inhaltsverzeichnis generieren</button>
                    <button class="secondary" onclick="clearAll()">üóëÔ∏è Zur√ºcksetzen</button>
                </div>
            </div>

            <div class="output-section" id="outputSection">
                <h2>Ergebnis</h2>

                <div class="stats" id="stats"></div>

                <div class="copy-buttons">
                    <button onclick="copyTOC()">üìã TOC kopieren</button>
                    <button onclick="copyHTML()">üìÑ HTML kopieren</button>
                </div>

                <div class="results">
                    <div class="toc-panel">
                        <h3>Inhaltsverzeichnis</h3>
                        <ul class="toc-list" id="tocList"></ul>
                    </div>
                    <div class="content-panel" id="contentPanel"></div>
                </div>
            </div>
        </div>

        <footer>
            <p><a href="/">‚Üê Zur√ºck zur √úbersicht</a></p>
        </footer>
    </div>

    <div class="toast" id="toast">Kopiert!</div>

    <script>
        function isLikelyHeading(line, prevLine, nextLine) {
            const trimmed = line.trim();

            // Skip empty lines
            if (!trimmed) return null;

            // Skip if already markdown or numbered
            if (trimmed.match(/^#{1,6}\s/) || trimmed.match(/^(\d+\.)+\s/)) return null;

            // Heuristics for heading detection:
            // 1. Line is relatively short (< 150 chars)
            // 2. Starts with capital letter or number
            // 3. Doesn't end with sentence punctuation (. , ; : !)
            // 4. Not too short (> 10 chars to avoid false positives)
            // 5. Previous or next line is empty (standalone line)

            const length = trimmed.length;
            const startsWithCapital = /^[A-Z√Ñ√ñ√ú0-9]/.test(trimmed);
            const endsWithPunctuation = /[.,;:!?]$/.test(trimmed);
            const hasEmptyContext = (!prevLine || prevLine.trim() === '') || (!nextLine || nextLine.trim() === '');

            // Not a heading if too long, ends with punctuation, or doesn't start with capital
            if (length > 150 || endsWithPunctuation || !startsWithCapital) return null;

            // Too short to be meaningful
            if (length < 10) return null;

            // Must have empty line before or after (standalone)
            if (!hasEmptyContext) return null;

            // Determine level based on length and formatting
            // Very short (< 50) = Level 1
            // Short (50-80) = Level 2
            // Medium (80-150) = Level 3

            let level;
            if (length < 50) {
                level = 1;
            } else if (length < 80) {
                level = 2;
            } else {
                level = 3;
            }

            return { level, text: trimmed };
        }

        function generateTOC() {
            const input = document.getElementById('inputText').value.trim();
            const autoDetect = document.getElementById('autoDetect').checked;

            if (!input) {
                alert('Bitte Text eingeben!');
                return;
            }

            const lines = input.split('\n');
            const headings = [];
            const contentHTML = [];
            let headingCounter = {};

            // Parse text and extract headings
            lines.forEach((line, index) => {
                const trimmed = line.trim();
                const prevLine = index > 0 ? lines[index - 1] : '';
                const nextLine = index < lines.length - 1 ? lines[index + 1] : '';

                // Detect Markdown headings (# ## ### etc.)
                const mdMatch = trimmed.match(/^(#{1,6})\s+(.+)$/);
                if (mdMatch) {
                    const level = mdMatch[1].length;
                    const text = mdMatch[2].trim();
                    const id = generateId(text, headingCounter);

                    headings.push({ level, text, id });
                    contentHTML.push(`<h${level} id="${id}">${escapeHtml(text)}<a href="#${id}" class="anchor-link">#</a></h${level}>`);
                    return;
                }

                // Detect numbered headings (1. 1.1 1.1.1 etc.)
                const numMatch = trimmed.match(/^(\d+\.)+\s+(.+)$/);
                if (numMatch) {
                    const dots = (trimmed.match(/\./g) || []).length;
                    const level = Math.min(dots, 6);
                    const text = trimmed.replace(/^(\d+\.)+\s+/, '').trim();
                    const id = generateId(text, headingCounter);

                    headings.push({ level, text: trimmed, id });
                    contentHTML.push(`<h${level} id="${id}">${escapeHtml(trimmed)}<a href="#${id}" class="anchor-link">#</a></h${level}>`);
                    return;
                }

                // Auto-detect headings from plain text (if enabled)
                if (autoDetect) {
                    const heading = isLikelyHeading(trimmed, prevLine, nextLine);
                    if (heading) {
                        const id = generateId(heading.text, headingCounter);
                        headings.push({ level: heading.level, text: heading.text, id });
                        contentHTML.push(`<h${heading.level} id="${id}">${escapeHtml(heading.text)}<a href="#${id}" class="anchor-link">#</a></h${heading.level}>`);
                        return;
                    }
                }

                // Regular text
                if (trimmed) {
                    contentHTML.push(`<p>${escapeHtml(trimmed)}</p>`);
                } else {
                    contentHTML.push('<br>');
                }
            });

            if (headings.length === 0) {
                const suggestion = autoDetect
                    ? 'Keine √úberschriften gefunden! Stelle sicher, dass √úberschriften auf eigenen Zeilen stehen und mit Leerzeilen getrennt sind.'
                    : 'Keine √úberschriften gefunden! Verwende # f√ºr Markdown, nummerierte √úberschriften (1., 1.1, etc.) oder aktiviere die Auto-Erkennung.';
                alert(suggestion);
                return;
            }

            // Generate TOC
            const tocHTML = generateTOCList(headings);
            document.getElementById('tocList').innerHTML = tocHTML;

            // Generate content
            document.getElementById('contentPanel').innerHTML = contentHTML.join('\n');

            // Show stats
            const stats = `
                <p><strong>√úberschriften gefunden:</strong> ${headings.length}</p>
                <p><strong>Ebenen:</strong> ${Math.max(...headings.map(h => h.level))}</p>
                <p><strong>Zeilen gesamt:</strong> ${lines.length}</p>
            `;
            document.getElementById('stats').innerHTML = stats;

            // Show output
            document.getElementById('outputSection').classList.add('active');

            // Scroll to output
            document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });
        }

        function generateTOCList(headings) {
            let html = '';
            headings.forEach(heading => {
                html += `<li class="toc-level-${heading.level}">
                    <a href="#${heading.id}">${escapeHtml(heading.text)}</a>
                </li>`;
            });
            return html;
        }

        function generateId(text, counter) {
            // Create URL-friendly ID
            let base = text.toLowerCase()
                .replace(/[^\w\s-√§√∂√º√ü]/g, '')
                .replace(/\s+/g, '-')
                .replace(/-+/g, '-')
                .substring(0, 50);

            if (!base) base = 'heading';

            // Handle duplicates
            if (counter[base] === undefined) {
                counter[base] = 0;
                return base;
            } else {
                counter[base]++;
                return `${base}-${counter[base]}`;
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyTOC() {
            const tocList = document.getElementById('tocList');
            const items = tocList.querySelectorAll('li');
            let text = 'Inhaltsverzeichnis\n\n';

            items.forEach(item => {
                const level = parseInt(item.className.match(/toc-level-(\d)/)[1]);
                const indent = '  '.repeat(level - 1);
                text += `${indent}- ${item.textContent.trim()}\n`;
            });

            copyToClipboard(text);
            showToast('Inhaltsverzeichnis kopiert!');
        }

        function copyHTML() {
            const content = document.getElementById('contentPanel').innerHTML;
            const toc = document.getElementById('tocList').innerHTML;
            const html = `<!-- Table of Contents -->\n<ul class="toc">\n${toc}\n</ul>\n\n<!-- Content -->\n${content}`;

            copyToClipboard(html);
            showToast('HTML kopiert!');
        }

        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        function clearAll() {
            document.getElementById('inputText').value = '';
            document.getElementById('outputSection').classList.remove('active');
        }

        function loadExample() {
            const example = `# ChatGPT Research Report: Artificial Intelligence in Healthcare

## 1. Executive Summary

This report examines the current state and future prospects of artificial intelligence applications in healthcare settings.

## 2. Introduction

### 2.1 Background

Artificial Intelligence (AI) has emerged as a transformative technology in healthcare.

### 2.2 Research Objectives

The primary objectives of this research are:
- Identify key AI applications in healthcare
- Evaluate effectiveness and challenges
- Propose recommendations for implementation

## 3. Current AI Applications

### 3.1 Medical Imaging

AI algorithms have shown remarkable performance in analyzing medical images.

#### 3.1.1 Radiology

Deep learning models can detect anomalies in X-rays and CT scans.

#### 3.1.2 Pathology

AI assists pathologists in identifying cancerous cells.

### 3.2 Predictive Analytics

Machine learning models predict patient outcomes and disease progression.

### 3.3 Drug Discovery

AI accelerates the drug discovery process by analyzing molecular structures.

## 4. Challenges and Limitations

### 4.1 Data Privacy

Patient data protection remains a critical concern.

### 4.2 Algorithm Bias

AI models may perpetuate existing healthcare disparities.

### 4.3 Regulatory Compliance

Healthcare AI must meet strict regulatory requirements.

## 5. Future Directions

### 5.1 Personalized Medicine

AI will enable truly personalized treatment plans.

### 5.2 Remote Patient Monitoring

Wearable devices combined with AI will revolutionize patient care.

## 6. Conclusions

AI has the potential to transform healthcare delivery and improve patient outcomes.

## 7. Recommendations

### 7.1 For Healthcare Providers

Invest in AI infrastructure and training.

### 7.2 For Policymakers

Develop clear regulatory frameworks for AI in healthcare.

### 7.3 For Researchers

Continue research on explainable AI and bias mitigation.`;

            document.getElementById('inputText').value = example;
            showToast('Beispiel geladen!');
        }

        function loadPlainTextExample() {
            const example = `Automatische Grafikerstellung f√ºr Astro-Blogposts

In diesem Leitfaden wird beschrieben, wie du automatisch zu jedem Blogpost in einem Astro-5-basierten Blogsystem eine minimalistische Vektorgrafik im einheitlichen Stil generierst.

Auswahl des LLM f√ºr Zusammenfassungen

F√ºr die Text-Zusammenfassung eines Blogposts in einen einzigen pr√§gnanten Satz eignet sich ein leistungsf√§higes Sprachmodell. Zwei Ans√§tze bieten sich an:

Externes API-LLM (Cloud)

Ein Dienst wie OpenAI GPT-3.5 Turbo kann sehr pr√§zise Zusammenfassungen liefern. Die Nutzung √ºber die API ist vergleichsweise kosteng√ºnstig (Bruchteile eines Cents pro Anfrage bei kurzem Text) und erfordert wenig Setup.

Open-Source LLM (self-hosted)

Falls du externe API-Kosten vermeiden m√∂chtest, kannst du ein lokales Modell einsetzen. Beispiele: Llama 2 (7B/13B) oder FLAN-T5 (f√ºr Summaries) oder GPT4All. Diese k√∂nnen auf einem Server (ggf. mit GPU) laufen.

Auswahl des Bildgenerierungs-Modells

Der zweite Schritt ist die Bildgenerierung im minimalistischen Vektorstil basierend auf der Text-Zusammenfassung.

Cloud-Dienst (fal.ai)

fal.ai stellt eine Plattform mit √ºber 600 vorgefertigten KI-Modellen zur Verf√ºgung, darunter viele Bildgeneratoren. Ein speziell hervorzuhebendes Modell ist Recraft V3, ein State-of-the-Art Text-to-Image-Modell.

Open-Source Stable Diffusion

Eine andere M√∂glichkeit ist, Stable Diffusion selbst zu nutzen ‚Äì entweder auf deiner eigenen Hardware oder √ºber Dienste wie HuggingFace Inference API, Replicate, StabilityAI's DreamStudio API.

Technischer Workflow

Jetzt betrachten wir den Ablauf im Detail, um aus einem neuen Blogartikel automatisch ein Bild zu erhalten.

Artikeltext extrahieren

Sobald ein neuer Blogpost (MDX-Datei) erstellt oder ein bestehender Beitrag noch kein Bild hat, wird dessen Inhalt ausgelesen.

LLM-Zusammenfassung erzeugen

F√ºttere den Artikeltext in das gew√§hlte LLM mit der Aufforderung, eine einzige pr√§gnante Satz-Zusammenfassung zu erzeugen.

Prompt f√ºr Bildgeneration erstellen

Nimm diesen einen Satz und forme ihn zu einem Eingabe-Prompt f√ºr das Bildmodell um.

Integration in den Astro-Build-Prozess

Wie l√§sst sich das oben Beschriebene technisch in Astro 5 einbinden?

Kostenkontrolle und Effizienz

Zum Schluss noch wichtige Hinweise, um die Kosten und Performance im Griff zu behalten.`;

            document.getElementById('inputText').value = example;
            document.getElementById('autoDetect').checked = true;
            showToast('Flie√ütext-Beispiel geladen! Auto-Erkennung aktiviert.');
        }

        // Handle Enter key in textarea (Ctrl+Enter to generate)
        document.getElementById('inputText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                generateTOC();
            }
        });
    </script>
</body>
</html>
